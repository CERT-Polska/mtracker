<html class=" ">
  <head>
    <meta charset="utf8">
    <title>mtracker</title>
    <script src="/js/jquery-1.12.4.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/bootswatch.min.css">
    <link rel="stylesheet" href="/css/app.css">
    <link rel="stylesheet" href="/css/bullet.css">
    <link rel="stylesheet" href="/css/flag-icon.css">
  </head>
  <body>
    <div id="content">
      <div class="container">
        <nav class="navbar navbar-default">
          <div class="container">
            <div class="navbar-header"><a class="navbar-brand" href="{{url_for('index')}}">mtracker</a></div>
            <ul class="nav navbar-nav">
              <li role="presentation"><a action="push" href="{{url_for('trackers')}}">trackers</a></li>
              <li role="presentation"><a action="push" href="{{url_for('bots')}}">bots</a></li>
              <li role="presentation"><a action="push" href="{{url_for('tasks')}}">tasks</a></li>
              <li role="presentation"><a action="push" href="{{url_for('results')}}">results</a></li>
              <li role="presentation"><a action="push" href="{{url_for('proxies')}}">proxies</a></li>
            </ul>
          </div>
        </nav>

        <!-- modal features -->
        <div id="logModal" class="modal fade" tabindex="-1">
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Task Log</h4>
              </div>
              <div class="modal-body">
                <pre id="logContent">Loading...</pre>
              </div>
            </div>
          </div>
        </div>

        <script>
        $(document).on("click", ".show-logs", function(e) {
            e.preventDefault();

            // Only one of task-id and bot-id can be set
            var taskId = $(this).data("task-id");
            var botId = $(this).data("bot-id");

            var log_url;
            if (taskId !== undefined) {
              log_url = "/api/tasks/" + taskId + "/log";
            } else if (botId !== undefined) {
              log_url = "/api/bots/" + botId + "/log";
            } else {
              console.error("Either task-id or bot-id must be set");
              return;
            }

            $("#logContent").text("Loading...");
            $("#logModal").modal("show");

            $.get(log_url)
                .done(function(response) {
                    $("#logContent").text(response.data);
                })
                .fail(function() {
                    $("#logContent").text("Failed to load log.");
                });
        });
        </script>

        <!-- end modal features -->

        <div id="real-content" class="well">
          {% block content %}
          {% endblock %}
        </div>
      </div>
    </div>
  </body>
</html>
